package model;

import org.junit.Test;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import static org.junit.Assert.assertEquals;

/**
 * Test class for Formating Utils.
 */
public class FormattingUtilsTest {

  @Test
  public void interval() {
    LocalDate date1 = LocalDate.of(2020, 1, 1);
    LocalDate date2 = LocalDate.of(2020, 1, 2);
    LocalDate dateYearFrom1 = LocalDate.of(2021, 1, 1);
    FormattingUtils format = new FormattingUtils();
    assertEquals(1, format.interval(date1, date2));
    assertEquals(1, format.interval(date2, date2));
    assertEquals(30, format.interval(date1, dateYearFrom1));
  }

  @Test
  public void barGraph() {
    LocalDate date1 = LocalDate.of(2020, 1, 1);
    LocalDate date2 = LocalDate.of(2020, 1, 2);
    LocalDate dateYearFrom1 = LocalDate.of(2021, 1, 1);
    FormattingUtils format = new FormattingUtils();
    Map<LocalDate, Double> values = new LinkedHashMap<>();
    values.put(date1, 1.0);
    values.put(date2, 2.0);
    values.put(dateYearFrom1, 3.0);

    assertEquals("2020-01-01 *\n" +
                    "2020-01-02 **\n" +
                    "2021-01-01 ***\n" +
                    "scale * 1.0000",
            format.barGraph(values, 1.0));
    // test with a larger amount of data
    Map<LocalDate, Double> values2 = new LinkedHashMap<>();
    for (int i = 0; i < 100; i++) {
      values2.put(date1.plusDays(i), (double) i);
    }
    assertEquals("2020-01-01 \n" +
            "2020-01-02 *\n" +
            "2020-01-03 **\n" +
            "2020-01-04 **\n" +
            "2020-01-05 ***\n" +
            "2020-01-06 ***\n" +
            "2020-01-07 ****\n" +
            "2020-01-08 ****\n" +
            "2020-01-09 *****\n" +
            "2020-01-10 *****\n" +
            "2020-01-11 ******\n" +
            "2020-01-12 ******\n" +
            "2020-01-13 *******\n" +
            "2020-01-14 *******\n" +
            "2020-01-15 ********\n" +
            "2020-01-16 ********\n" +
            "2020-01-17 *********\n" +
            "2020-01-18 *********\n" +
            "2020-01-19 **********\n" +
            "2020-01-20 **********\n" +
            "2020-01-21 ***********\n" +
            "2020-01-22 ***********\n" +
            "2020-01-23 ************\n" +
            "2020-01-24 ************\n" +
            "2020-01-25 *************\n" +
            "2020-01-26 *************\n" +
            "2020-01-27 **************\n" +
            "2020-01-28 **************\n" +
            "2020-01-29 ***************\n" +
            "2020-01-30 ***************\n" +
            "2020-01-31 ****************\n" +
            "2020-02-01 ****************\n" +
            "2020-02-02 *****************\n" +
            "2020-02-03 *****************\n" +
            "2020-02-04 ******************\n" +
            "2020-02-05 ******************\n" +
            "2020-02-06 *******************\n" +
            "2020-02-07 *******************\n" +
            "2020-02-08 ********************\n" +
            "2020-02-09 ********************\n" +
            "2020-02-10 *********************\n" +
            "2020-02-11 *********************\n" +
            "2020-02-12 **********************\n" +
            "2020-02-13 **********************\n" +
            "2020-02-14 ***********************\n" +
            "2020-02-15 ***********************\n" +
            "2020-02-16 ************************\n" +
            "2020-02-17 ************************\n" +
            "2020-02-18 *************************\n" +
            "2020-02-19 *************************\n" +
            "2020-02-20 **************************\n" +
            "2020-02-21 **************************\n" +
            "2020-02-22 ***************************\n" +
            "2020-02-23 ***************************\n" +
            "2020-02-24 ****************************\n" +
            "2020-02-25 ****************************\n" +
            "2020-02-26 *****************************\n" +
            "2020-02-27 *****************************\n" +
            "2020-02-28 ******************************\n" +
            "2020-02-29 ******************************\n" +
            "2020-03-01 *******************************\n" +
            "2020-03-02 *******************************\n" +
            "2020-03-03 ********************************\n" +
            "2020-03-04 ********************************\n" +
            "2020-03-05 *********************************\n" +
            "2020-03-06 *********************************\n" +
            "2020-03-07 **********************************\n" +
            "2020-03-08 **********************************\n" +
            "2020-03-09 ***********************************\n" +
            "2020-03-10 ***********************************\n" +
            "2020-03-11 ************************************\n" +
            "2020-03-12 ************************************\n" +
            "2020-03-13 *************************************\n" +
            "2020-03-14 *************************************\n" +
            "2020-03-15 **************************************\n" +
            "2020-03-16 **************************************\n" +
            "2020-03-17 ***************************************\n" +
            "2020-03-18 ***************************************\n" +
            "2020-03-19 ****************************************\n" +
            "2020-03-20 ****************************************\n" +
            "2020-03-21 *****************************************\n" +
            "2020-03-22 *****************************************\n" +
            "2020-03-23 ******************************************\n" +
            "2020-03-24 ******************************************\n" +
            "2020-03-25 *******************************************\n" +
            "2020-03-26 *******************************************\n" +
            "2020-03-27 ********************************************\n" +
            "2020-03-28 ********************************************\n" +
            "2020-03-29 *********************************************\n" +
            "2020-03-30 *********************************************\n" +
            "2020-03-31 **********************************************\n" +
            "2020-04-01 **********************************************\n" +
            "2020-04-02 ***********************************************\n" +
            "2020-04-03 ***********************************************\n" +
            "2020-04-04 ************************************************\n" +
            "2020-04-05 ************************************************\n" +
            "2020-04-06 *************************************************\n" +
            "2020-04-07 *************************************************\n" +
            "2020-04-08 **************************************************\n" +
            "2020-04-09 **************************************************\n" +
            "scale * 1.9800", format.barGraph(values2, 99.0));
  }


  @Test
  public void createTable() {
    FormattingUtils format = new FormattingUtils();
    List<String> table = new ArrayList<>();
    assertEquals("header\n", format.createTable(table, "header"));
    table.add("a  1");
    table.add("b  2");
    table.add("c  3");
    assertEquals("header\na\nb\nc", format.createTable(
            java.util.Arrays.asList("a", "b", "c"), "header"));
  }
}